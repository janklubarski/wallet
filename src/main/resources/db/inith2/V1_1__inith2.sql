CREATE TABLE APP_USER (
    ID BIGINT PRIMARY KEY,
    USERNAME VARCHAR(255) UNIQUE NOT NULL,
    PASSWORD VARCHAR(255) NOT NULL,
    CREATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE WALLET (
    ID BIGINT PRIMARY KEY,
    USER_ID BIGINT NOT NULL REFERENCES APP_USER(ID),
    BALANCE NUMERIC(15,2) NOT NULL DEFAULT 0.00,
    WALLET_NAME VARCHAR(100) NOT NULL,
    CURRENCY VARCHAR(3) NOT NULL
);

CREATE TABLE TRANSACTION_LOG (
    ID BIGINT PRIMARY KEY,
    WALLET_ID BIGINT NOT NULL REFERENCES WALLET(ID),
    AMOUNT NUMERIC(15,2) NOT NULL,
    CURRENCY VARCHAR(3) NOT NULL,
    TRANSACTION_TYPE VARCHAR(20), -- INCOME, WITHDRAWAL, TRANSFER
    DESCRIPTION TEXT,
    VARIABLE_SYMBOL VARCHAR(20),
    TRANSACTION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    STATUS VARCHAR(20),
    BANK_ACCOUNT_NUMBER VARCHAR(34), -- IBAN support (max 34 chars)
    DESTINATION_WALLET_ID BIGINT     -- Nullable, for transfer target
);

CREATE SEQUENCE USER_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE WALLET_SEQ START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE TRANSACTION_SEQ START WITH 1 INCREMENT BY 1;
